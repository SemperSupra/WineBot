# Status Report - 2026-02-02

## Milestone: Agent-Ready API & Enhanced Headless Support

We have completed a major overhaul of the automation layer, introducing an internal HTTP API and robust helper scripts to make WineBot easily controllable by autonomous agents and external scripts.

### 1. New Features
- **Internal API (`port 8000`):**
    - **Vision:** `/screenshot` with labeling and window targeting.
    - **Control:** `/input/mouse/click`, `/windows/focus`.
    - **State:** `/windows` (list), `/windows/active`, `/health`.
    - **Automation:** `/run/ahk`, `/run/autoit`, `/run/python`, `/apps/run`.
- **Headless Helpers:**
    - `automation/x11.sh`: Unified wrapper for `xdotool`/`xprop` interactions.
    - `scripts/run-ahk.sh` & `run-autoit.sh`: Robust script runners that handle Wine bootstrapping and logging.
    - `automation/screenshot.sh`: Hardened capture tool with environment auto-detection.
- **Security:**
    - **Authentication:** `API_TOKEN` environment variable enforces `X-API-Key` verification.
    - **Input Validation:** File paths restricted to safe directories (`/apps`, `/wineprefix`, `/tmp`).

### 2. Improvements & Maintenance
- **Dependencies:**
    - Upgraded Windows Python from `3.12.8` to `3.13.11`.
    - Aligned with Linux container Python version.
- **Cleanup:**
    - Removed obsolete scripts (`click_xy.sh`, `run-headless.sh`).
    - Standardized on `docker compose` workflows.
- **Documentation:**
    - Created **`AGENTS.md`**: Definitive guide for automated interaction.
    - Updated `README.md`, `architecture.md`, `api.md`.

### 3. Verification
- **Smoke Tests:** `scripts/smoke-test.sh` passes successfully.
    - Validates X11 desktop, API endpoints (health, execution), and tool installation.
    - 11 Unit Tests (`pytest`) pass.

### 4. Next Steps / Future Work
- **Security Hardening (Strategy B):**
    - Implement network isolation profiles in Compose.
    - Enforce VNC password requirements in entrypoint.
    - Read-only volume mounts.
- **Feature Expansion:**
    - Add `/clipboard` endpoints (get/set text).
    - Add file upload/download via API.

### 5. Recommendation
- **Release:** Ready for `v0.5.0`.
